\subsection{Kompressionsverfahren: Prädiktive Kodierung}  \label{resultate:loesung2}
In diesem Abschnitt wird das Kompressionsverfahren der Prädiktiven Kodierung besprochen. Es wurde der Einfluss von verschiedenen Prädiktoren getestet. Die Schwierigkeit dieses Verfahrens liegt in der Quantisierung des Vorhersagefehlers. Die Quantisierung der Fehler von einfacher Prädiktoren führt zu hohen Abweichungen in der Dekompression. Der Rekursive Lineare Prädiktor unter Abschnitt \ref{resultate:loesung2:wavelet} löst das Problem.

\subsubsection{Variante: einfaches Subsampling}
Für die erste Variante wird das Subsampling des DCT-Kompressionsverfahren verwendet. Es reduziert die Punktmenge auf die Anzahl des Ist-Zustands. Die Feldlinien werden mit einer PCA in ein lokales Koordinatensystem transformiert. Im lokalen System können die Koordinaten mit 16 Bit Genauigkeit dargestellt werden. 16 Bit im Koordinatensystem der Sonne reichen nicht aus und führen zu einer grösseren Abweichung als der Ist-Zustand.\\
In dieser Variante wird der Einfluss von vier Prädiktoren getestet ($x$ sind die Bekannten Punkte und $y$ die Vorhersage):
\begin{itemize}
\item Konstanter Prädiktor: Nimmt an, dass der nächste Wert im Kanal gleich dem  letzten Wert ist ($x = y$).
\item Linearer Prädiktor: Nimmt an, dass die Steigung die Steigung zum nächsten Wert konstant bleibt ($x_1+(-x_2+x_1) = y$).
\item Linearer Prediktor mit Moving Average: Nimmt die durchschnittliche Steigung der letzten Werte.
\item Adaptiver Linearer Prädiktor mit Moving Average: Berücksichtigt den Fehler der letzten Vorhersage.
\end{itemize}

\begin{figure}[!htbp]
	\center
	\includegraphics[width=1\textwidth,keepaspectratio]{./pictures/resultate/loesung2/variante0/resultate.png}
	\caption{Kompressionsraten der vier Prediktoren im Vergleich zum Ist-Zustand.}
	\label{resultate:loesung2:simple:resultate}
\end{figure}
Im Diagramm der Abbildung \ref{resultate:loesung2:simple:resultate} sind die Kompressionsraten der jeweiligen Prädiktoren dargestellt. Ein Diagramm mit der PSNR-HVS-M wurde nicht erstellt. Sie ist für alle Prädiktoren gleich und liegt bei $140.7$ dB. Unerwartet ist, dass der Konstante Prädiktor mit $255$ Bytes pro Feldlinie die beste Kompression erreichte, obwohl die Daten nicht zuverlässig vorhersagen kann. Im Vergleich mit dem Moving Average Prädiktor sind die Fehler der Vorhersagen 
bis zu $5$ Mal grösser, verbrauchen aber $40$ Bytes weniger um eine Feldlinie abzuspeichern. Eine Erklärung ist, dass die RAR Kodierung sich wiederholende Muster findet.

Eine mögliche Optimierung ist die Adaptive Kodierung der DCT-Variante, beschrieben im Abschnitt \ref{konzept:loesung1:kodierung}. Das Diagramm der Abbildung \ref{resultate:loesung2:simple:resultate_byte} zeigt die Resultate mit der Kodierung. Der Konstante Prädiktor verbraucht mit der Adaptiven Kodierung mehr Speicherplatz. Die Kompressionsrate der anderen Prädiktoren wird durch die Adaptive Kodierung deutlich verbessert. Der Lineare Prädiktor erreicht mit $214$ Bytes pro Feldlinie die beste Kompression. Es bestätigt die Vermutung, dass der Konstante Prädiktor keine zuverlässige Vorhersage erreichte und die Kompressionsrate auf die RAR Kodierung zurückzuführen ist. Der Lineare Prädiktor kann eine Feldlinie mit etwa $214$ Bytes darstellen, was eine Kompressionsrate von $4$ ergibt.

\begin{figure}[!htbp]
	\center
	\includegraphics[width=1\textwidth,keepaspectratio]{./pictures/resultate/loesung2/variante0/resultate_byte.png}
	\caption{Kompressionsraten der Prediktoren mit Adaptiver Kodierung.}
	\label{resultate:loesung2:simple:resultate_byte}
\end{figure}


\subsubsection{Variante: Adaptives Subsampling} \label{resultate:loesung2:adaptive}
Um die Kompressionsrate der Prädiktiven Kodierung in dieselbe Grössenordnung zu gelangen wie die Kompressionen des Adaptives Subsampling oder der DCT müssen mehr Informationen gelöscht werden. Deshalb wird das Adaptive Subsampling eingesetzt, es werden andere Parameter verwendet und im Schnitt $50\%$ mehr Daten übertragen als in der Kompression des Adaptiven Subsampling.

\begin{figure}[!htbp]
	\center
	\includegraphics[width=1\textwidth,keepaspectratio]{./pictures/resultate/loesung2/variante1/resultate_euler.png}
	\caption{Kompressionsraten der Prediktiven Kodierungen mit dem adaptiven Subsampling.}
	\label{resultate:loesung2:adaptive:euler}
\end{figure}
Das Diagramm der Abbildung \ref{resultate:loesung2:adaptive:euler} zeigt die Kompressionsraten. Die Resultate liegen dicht beieinander und der Abstand zwischen Kodierung und der Kompression, welche ohne Kodierung erreicht wird wurde drastisch vermindert. Die Kodierungen erreichen eine PSNR-HVS-M von $139,2$. Das Angle Subsampling verändert die Eigenschaften der Daten. Die Diagramme der Abbildung \ref{resultate:loesung2:adaptive:channel} zeigen die Veränderung: Monotone Steigungen sind nach dem Subsampling nicht mehr vorhanden. Die einfachen Prädiktoren können die Daten nicht zuverlässig vorhersagen.

\begin{figure}[!htbp]
	\center
	\includegraphics[width=0.49\textwidth,height=5cm,keepaspectratio]{./pictures/resultate/loesung2/variante1/channel_sub.png}
	\includegraphics[width=0.49\textwidth,height=5cm,keepaspectratio]{./pictures/resultate/loesung2/variante1/channel_angle.png}
	\caption{Änderung der Eigenschaften der Daten durch das Angle Subsampling. Links der Kanal einer Feldlinie vor, rechts der Kanal nach dem Angle Subsampling.}
	\label{resultate:loesung2:adaptive:channel}
\end{figure}

\subsubsection{Rekursive Lineare Kodierung} \label{resultate:loesung2:wavelet}
Die Rekursive Lineare Kodierung ist in der Lage nicht-stetigen Kanälen eine sinnvolle Vorhersage zu berechnen. Das Verfahren ist im Abschnitt \ref{konzept:prediktiv} genauer erläutert. Die Punkte werden ins sphärische Koordinatensystem überführt. In diesem Koordinatensystem sind 16 Bit Genauigkeit pro Koordinatenachse ausreichend und die PCA muss nicht berechnet werden. Im Schnitt können dadurch $30$ Bytes pro Feldlinie eingespart werden. Zusätzlich werden die Vorhersagefehler quantisiert.

\begin{figure}[!htbp]
	\center
	\includegraphics[width=1\textwidth,keepaspectratio]{./pictures/resultate/loesung2/variante2/resultate.png}
	
	\caption{Kompressionsraten der Rekursiven Linearen Kodierung mit dem adaptiven Subsampling.}
	\label{resultate:loesung2:adaptive:median}
\end{figure}
\begin{figure}[!htbp]
	\includegraphics[width=1\textwidth,keepaspectratio]{./pictures/resultate/loesung2/variante2/resultate_psnr.png}
	
	\caption{Kompressionsraten der Rekursiven Linearen Kodierung mit dem adaptiven Subsampling.}
	\label{resultate:loesung2:adaptive:median_psnr}
\end{figure}
Das Diagramm der Abbildung \ref{resultate:loesung2:adaptive:median} zeigt die Standardabweichung der Rekursiven Linearen Kodierung zu unterschiedlichen Quantisierungen. Das Diagramm der Abbildung \ref{resultate:loesung2:adaptive:median_psnr} zeigt die PSNR-HVS-M Werte der Variante. Die Resultate der einfachen Prädiktoren wurden ebenfalls ohne PCA im sphärischen Koordinatensystem gemessen. Die Rekursive Lineare Kodierung kann eine bessere Kompressionsrate erreichen als die Kompression mit Adaptiven Subsampling. Bei Datenmenge von $64$ Bytes pro Feldlinie erreicht diese Variante eine tiefere Standardabweichung als das Adaptive Subsampling zu einem PSNR-HVS-M Wert von $94.7$. Diese Variante besitzt weniger ausgeprägte Artefakte als das DCT Verfahren, weist aber eine höhere Standardabweichung auf. Die Variante erreicht eine Kompressionsrate von $13.4$ und fällt somit zwischen den Kompressionen mittels DCT und Adaptives Subsampling.

Die Artefakte der Dekompression äussern sich meist als Verschiebungen einzelner Punkte. Im Extremfall können Ringing ähnlichen Artefakte entstehen, welche in der Abbildung \ref{resultate:loesung2:adaptive:median:artefakte} dargestellt sind. Der Grund für die Artefaktbildung liegt in der Rekursion: Wenn der Vorhersagefehler des ersten Wertes (siehe Diagramm der Abbildung \ref{konzept:loesung2:algorithm:step1}) quantisiert wird, beeinflusst der Quantisierungsfehler den gesamten Kanal. Die Werte, welches als letztes kodiert werden, erfahren die grösste Verschiebung bei der Dekompression. Diese Variante verwendet einen konstanten Faktor für die Quantisierung. Die Lösung ist eine angepasste Quantisierung, welche die ersten Vorhersagefehler der ersten Rekursionsstufe mit höherer Genauigkeit abspeichert.

\begin{figure}[!htbp]
	\center
		\includegraphics[width=0.49\textwidth,height=5cm,keepaspectratio]{./pictures/resultate/loesung2/variante3/no_artifacts.png}
	\includegraphics[width=0.49\textwidth,height=5cm,keepaspectratio]{./pictures/resultate/loesung2/variante3/artifacts_8.png}
	\caption{Artefakte der Rekursiven Linearen Kodierung. Links sind die originalen Feldlinien.}
	\label{resultate:loesung2:adaptive:median:artefakte}
\end{figure}

\subsubsection{Rekursive Lineare Kodierung mit angepasster Quantisierung}
Um die Artefakte der Dekompression zu dämpfen werden die Vorhersagefehler der Rekursionsstufe angepasst quantisiert. Die ersten Rekursionsstufen werden mit höherer Genauigkeit abgelegt.

\begin{figure}[!htbp]
	\center
	\includegraphics[width=1\textwidth,keepaspectratio]{./pictures/resultate/loesung2/variante3/resultate.png}
		
		\caption{Standardabweichung der Rekursiven Linearen Kodierung mit angepasster Quantisierung.}
		\label{resultate:loesung2:adaptive:median:quant}
\end{figure}
\begin{figure}[!htbp]
\center
	\includegraphics[width=1\textwidth,keepaspectratio]{./pictures/resultate/loesung2/variante3/resultate_psnr.png}
	
	\caption{PSNR-HVS-M der Rekursiven Linearen Kodierung mit angepasster Quantisierung.}
	\label{resultate:loesung2:adaptive:median:quant_psnr}
\end{figure}
Die Angepasste Quantisierung bringt eine Verbesserung in der Standardabweichung mit sich. Die Diagramme der Abbildungen \ref{resultate:loesung2:adaptive:median:quant} und \ref{resultate:loesung2:adaptive:median:quant_psnr} visualisieren die Standardabweichung und PSNR-HVS-M zur jeweiligen Kompression. Mit der angepassten Quantisierung kann diese Variante eine ähnliche Kompression zu vergleichbaren PSNR-HVS-M erreichen, wie das DCT Kompressionsverfahren. Mit einer PSNR-HVS-M von $95.5$ verbraucht diese Variante $63$ Bytes pro Feldlinie, was zu einer Kompressionsrate von $13.6$ führt. Der Vorteil dieser Variante gegenüber der DCT Kompression ist, das wenige zusätzliche Bytes die Artefakten stark dämpfen können. 

Die Artefakte haben sich im Vergleich zur vorhergehenden Variante verbessert: Die Abbildung \ref{resultate:loesung2:adaptive:median_extra:artefakte} zeigt die Artefaktbildung dieser Variante. Die ringing-ähnlichen Artefakte sind verschwunden. In dieser Variante äussern sich Kompressionsartefakte als Verschiebung einzelner Punkte. Bei hoher Dichte der Feldlinien werden die Verschiebungen sichtbar, da sie sich häufig kreuzen und eine unästhetische Visualisierung ergeben. Eine leichte Glättung der Feldlinien versteckt die Artefakte und gestaltet eine ästhetische Visualisierung.

\begin{figure}[!htbp]
	\center
		\includegraphics[width=0.49\textwidth,height=5cm,keepaspectratio]{./pictures/resultate/loesung2/variante3/no_artifacts.png}
	\includegraphics[width=0.49\textwidth,height=5cm,keepaspectratio]{./pictures/resultate/loesung2/variante3/artifacts_extra.png}
	\caption{Artefakte der Rekursiven Linearen Kodierung mit angepasster Quantisierung.Links sind die originalen Feldlinien.}
	\label{resultate:loesung2:adaptive:median_extra:artefakte}
\end{figure}

Das Caching von $1000$ Simulationen und die Übertragungszeit fallen zwischen die anderen Kompressionsverfahren mit $72$ Megabyte an Arbeitsspeicher beziehungsweise $118$ Sekunden Übertragungszeit. Zum Vergleich: Die DCT Variante verbraucht unter denselben Bedingungen $70$ und das Adaptive Subsampling $85$ Megabyte an Arbeitsspeicher. Bei einer Internetverbindung von $5$ Megabit ist bei diesem Verfahren mit einer Übertragungsrate von $8$ Simulationen in der Sekunde zu rechnen. Die Laufzeit der Dekompression liegt mit $30.6$ Millisekunden ebenfalls zwischen den Kompressionsverfahren Adaptives Subsampling und DCT (siehe Abschnitt \ref{anhang:performance}). Mit dieser Laufzeit kann ein Thread durchschnittlich $32$ Simulationen pro Sekunde dekomprimieren.